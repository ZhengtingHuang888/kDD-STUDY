import pymysqlfrom pygeohash import encode, decodefrom Astar1.auto import *def points_encode(start, end):    lat1, lon1 = start[1], start[0]    lat2, lon2 = end[1], end[0]    return encode(lat1, lon1), encode(lat2, lon2)def change_bd09(code):    lon,lat = decode(code)    point = wgs84tobd09(lon, lat)    return pointdef get_route(start_code, end_code):    db = pymysql.connect('localhost', 'root', 'hzt123', 'trases')    cursor = db.cursor()    cursor.execute('select route_0,route_1,route_2 where start_fivecode = {} and end_fivecode = {};'.format(start_code[:5], end_code[:5]))    routs_datas = cursor.fetchall()    all_routs = []    for rout in routs_datas:        all_routs.append(eval(rout))    cursor.execute('select start_code, end_code where start_fivecode = {} and end_fivecode = {};'.format(start_code[:5],end_code[:5]))    station_code = cursor.fetchall()    start_code = station_code[0]    end_code = station_code[1]    return all_routs, start_code, end_codedef choose_station(all_routs, start_code, end_code, start, end):    central_start = change_bd09(start_code)    central_end = change_bd09(end_code)    route_new = []    for route in all_routs:        if len(route) == 2:            route_new.append(route)        else:            strat_stations1 = route[1:3]            end_stations1 = route[-4:-2]            strat_stations = []; end_stations = []            for strat_station in strat_stations1:                dis =  get_lonlat_from_id(strat_station)                strat_stations.append(dis)            for end_station in end_stations1:                dis = get_lonlat_from_id(end_station)                end_stations.append(dis)            first_start = euclid(strat_stations[0], start)            second_start = euclid(strat_stations[1],start)            first_end = euclid(end_stations[0], end)            second_end = euclid(end_stations[1], end)            if second_start < first_start:                route.remove(strat_stations1[0])            if second_end > first_end:                route.remove(end_stations1[1])            route_new.append(route)    return route_new, start, end# 传入id，return经纬度def get_lonlat_from_id(id):    sql = "SELECT lon,lat FROM stations WHERE id = %d" % id    db = pymysql.connect('localhost', 'root', 'hzt123', 'trases')    cursor = db.cursor()    cursor.execute(sql)    result = cursor.fetchall()    # 返回经度、纬度；    return [result[0][0],result[0][1]]# get_route('ws0ehkqb1meh', 'ws0s2kr3g89e')#innsert_fivecode()start_code = 'ws0ehkqb1meh'end_code = 'ws0dfs0fh9n3'all_routs = [[-1, 82, 137, 136, 135, 53, 54, 55, 56, 33, 34, 35, 36, 37, 133, -2],[-1, 2701, 1693, 8142, 1195, -2],[-1, 82, 137, 136, 135, 53, 134, 133, -2]]route_new, start, end = choose_station(all_routs,start_code,end_code,[decode(start_code)],[decode(end_code)])print(route_new)